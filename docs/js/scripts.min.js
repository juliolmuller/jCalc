"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var Calculator=function(){function Calculator(){_classCallCheck(this,Calculator),this._time=document.querySelector("#hora"),this._date=document.querySelector("#data"),this._operationElements=[0],this._display=document.querySelector("#display"),this._withAudio=!0,this._audio=new Audio("./assets/click.mp3"),this.initialize(),this._lastOperator=void 0,this._lastOperated=void 0,this._lastButtonPressed=void 0}return _createClass(Calculator,[{key:"initialize",value:function(){var e=this;e.refreshDateTime(),e.refreshDisplay(),setInterval(function(){e.refreshDateTime()},1e3),e.initAudioEvent(),e.initButtonsEvents(),e.initKeyboardEvents()}},{key:"refreshDateTime",value:function(){this.displayTime=this.currentDate.toLocaleTimeString(LOCALE),this.displayDate=this.currentDate.toLocaleDateString(LOCALE,{day:"2-digit",month:"long",year:"numeric"})}},{key:"refreshDisplay",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;if(e=e||this.lastNumber.toString(),!isNaN(e)){e=e.toString();var t=(e=this.addDecimalSep(e)).indexOf(DECIMAL_SEP),i=e.substr(t+1,MAX_LENGTH-t).length;if(t>MAX_LENGTH)return void this.throwError(ErrorMsg.OVERFLOW);0<=i&&(e=parseFloat(parseFloat(e).toFixed(i))),e=this.addDecimalSep(e)}this.display=e}},{key:"addDecimalSep",value:function(e){return this.hasDecimals(e)||(e+=DECIMAL_SEP),e}},{key:"hasDecimals",value:function(e){return-1<e.toString().indexOf(DECIMAL_SEP)}},{key:"initAudioEvent",value:function(){var t=this,i=document.getElementById("toggle-audio");i.addEventListener("click",function(e){t._withAudio=!t._withAudio,t._withAudio?(t.playAudio(),i.src="./assets/images/sound-on.png"):i.src="./assets/images/sound-off.png"})}},{key:"initButtonsEvents",value:function(){var i=this,n=document.querySelectorAll("#buttons > g, #parts > g");["click","drag"].forEach(function(e){n.forEach(function(t){t.addEventListener(e,function(){var e=t.className.baseVal.replace("btn-","");i.pressButton(e)})})}),["mouseover","mouseup","mousedown"].forEach(function(t){n.forEach(function(e){e.addEventListener(t,function(){e.style.cursor="pointer"})})})}},{key:"initKeyboardEvents",value:function(){var i=this;document.addEventListener("keyup",function(e){var t=e.key.toLowerCase();e.ctrlKey&&"c"==t?(i.playAudio(),i.copyFromDisplay()):i.pressButton(KEYS_MAP[t])}),document.addEventListener("paste",function(e){var t=e.clipboardData.getData("Text");isNaN(t)?alert('Você está tentando colar conteúdo que não é numérico:\n"'.concat(t,'"')):(i.playAudio(),i.captureOperation(t),i.refreshDisplay(),console.log("Conteúdo colado com sucesso!"))})}},{key:"copyFromDisplay",value:function(){var e=document.createElement("input");document.body.appendChild(e),e.value=parseFloat(this.display),e.select(),document.execCommand("Copy"),e.remove(),console.log("Conteúdo copiado com sucesso!")}},{key:"pressButton",value:function(e){if(e in BUTTONS_MAP){switch(this.playAudio(),e){case"ac":this.clearAll();break;case"ce":this.clearEntry();break;case"igual":case"porcento":this.calculate(BUTTONS_MAP[e]);break;default:this.captureOperation(BUTTONS_MAP[e])}this._lastButtonPressed=BUTTONS_MAP[e],this.refreshDisplay()}}},{key:"playAudio",value:function(){this._withAudio&&(this._audio.currentTime=0,this._audio.play())}},{key:"clearAll",value:function(){this._operationElements=[0],this._lastOperator=void 0,this._lastOperated=void 0}},{key:"clearEntry",value:function(){1==this._operationElements.length?this.clearAll():3==this._operationElements.length&&(this._operationElements[2]=0)}},{key:"calculate",value:function calculate(operation){var _this=this;if(-1!=OP_TRIGGERS.indexOf(operation)){var isDividingByZero=function(){return"/"==_this._operationElements[1]&&0==_this._operationElements[2]&&(_this._operationElements=[0],_this.throwError(ErrorMsg.DIV_0),!0)};-1<OP_TRIGGERS.indexOf(this._lastButtonPressed)&&"="==operation&&(this.pushOperation(this._lastOperator),this.pushOperation(this._lastOperated));var result,len=this._operationElements.length;switch(len){case 1:"%"==operation?result=this._operationElements[0]/100:"="==operation&&(result=this._operationElements[0]);break;case 2:this._operationElements.push(this._operationElements[0]);case 3:if(isDividingByZero())return;"%"==operation&&(-1<ADD_SUB.indexOf(this._operationElements[1])?this._operationElements[2]=this._operationElements[0]*this._operationElements[2]/100:this._operationElements[2]=this._operationElements[2]/100),this._lastOperator=this._operationElements[1],this._lastOperated=this._operationElements[2],result=eval(this._operationElements.join(""))}this._operationElements=[result]}}},{key:"throwError",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;e=e||ErrorMsg.GENERAL,this.refreshDisplay(e)}},{key:"captureOperation",value:function(e){this.isOperator(this.lastOperationElement)?this.isOperator(e)?this.lastOperationElement=e:e==DECIMAL_SEP?this.pushOperation("0"+DECIMAL_SEP):isNaN(e)||this.pushOperation(parseInt(e)):isNaN(this.lastOperationElement)||(this.isOperator(e)?this.pushOperation(e):"="!=this._lastButtonPressed||isNaN(e)?e!=DECIMAL_SEP||this.hasDecimals(this.lastOperationElement)?isNaN(e)||(0==e&&this.hasDecimals(this.lastOperationElement)?this.lastOperationElement+=e:this.lastOperationElement=parseFloat(this.lastOperationElement+e)):this.lastOperationElement+=e:e==DECIMAL_SEP?this._operationElements=["0"+DECIMAL_SEP]:isNaN(e)||(this._operationElements=[parseInt(e)]))}},{key:"isOperator",value:function(e){return-1<OP_SYMBOLS.indexOf(e)}},{key:"pushOperation",value:function(e){3==this._operationElements.length&&this.calculate("="),this._operationElements.push(e)}},{key:"lastNumber",get:function(){return 2 in this._operationElements?this._operationElements[2]:this._operationElements[0]}},{key:"lastOperationElement",get:function(){return this._operationElements[this._operationElements.length-1].toString()},set:function(e){this._operationElements[this._operationElements.length-1]=e}},{key:"display",get:function(){return this._display.innerHTML},set:function(e){this._display.innerHTML=e}},{key:"displayTime",set:function(e){this._time.innerHTML=e}},{key:"displayDate",set:function(e){this._date.innerHTML=e}},{key:"currentDate",get:function(){return new Date}}]),Calculator}();
"use strict";var LOCALE="PT-BR",DECIMAL_SEP=".",MAX_LENGTH=10,ErrorMsg={GENERAL:"#ERROR#",DIV_0:"#DIV 0#",OVERFLOW:"#OVERFLOW#"},ADD_SUB=["+","-"],MUL_DIV=["*","/"],OP_SYMBOLS=ADD_SUB.concat(MUL_DIV),OP_TRIGGERS=["=","%"],KEYS_MAP={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",".":"ponto",",":"ponto","+":"soma","-":"subtracao","*":"multiplicacao","/":"divisao","=":"igual",enter:"igual","%":"porcento",escape:"ac",backspace:"ce",delete:"ce",c:"copy"},BUTTONS_MAP={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,ac:"ac",ce:"ce",ponto:DECIMAL_SEP,soma:"+",subtracao:"-",multiplicacao:"*",divisao:"/",igual:"=",porcento:"%"};
"use strict";window.calculator=new Calculator;
